<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tres en Raya â€” PWA</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png" type="image/png">
  <meta name="theme-color" content="#22c1c3">
  <style>
    body {
      margin:0; font-family:sans-serif; color:#fff;
      display:flex; align-items:center; justify-content:center;
      height:100vh;
      background:linear-gradient(180deg,#071026 0%, #0c1620 100%);
    }
    .app { text-align:center; }
    .board {
      display:grid;
      grid-template-columns:repeat(3,100px);
      gap:8px;
      margin:20px auto;
    }
    .cell {
      width:100px; height:100px;
      display:flex; align-items:center; justify-content:center;
      font-size:2.5rem; background:#1e293b;
      border-radius:8px; cursor:pointer;
    }
    .cell:hover { background:#334155; }
    button {
      margin:5px; padding:8px 12px;
      border:none; border-radius:6px;
      cursor:pointer;
    }
    .primary { background:#22c1c3; color:#000; }
  </style>
</head>
<body>
  <div class="app">
    <h1>Tres en Raya (PWA)</h1>
    <div id="board" class="board"></div>
    <p id="status">Turno: X</p>
    <button id="restart" class="primary">Reiniciar</button>
  </div>

  <script>
    const boardEl = document.getElementById("board");
    const statusEl = document.getElementById("status");
    const restartBtn = document.getElementById("restart");

    let state = Array(9).fill("");
    let turn = "X";
    let finished = false;

    function render() {
      boardEl.innerHTML = "";
      state.forEach((v,i)=>{
        const c = document.createElement("div");
        c.className="cell";
        c.dataset.index=i;
        c.textContent=v;
        c.onclick=onCell;
        boardEl.appendChild(c);
      });
      if(!finished) statusEl.textContent = `Turno: ${turn}`;
    }

    function onCell(e){
      if(finished) return;
      const i = e.target.dataset.index;
      if(state[i]) return;
      state[i]=turn;
      if(checkWin()){
        finished=true;
        statusEl.textContent=`Ganador: ${turn}`;
      } else if(state.every(Boolean)){
        finished=true;
        statusEl.textContent="Empate";
      } else {
        turn = turn==="X" ? "O" : "X";
      }
      render();
    }

    function checkWin(){
      const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
      return wins.some(([a,b,c])=>state[a] && state[a]===state[b] && state[a]===state[c]);
    }

    restartBtn.onclick=()=>{
      state=Array(9).fill(""); turn="X"; finished=false; render();
    };

    render();

    // Registrar Service Worker
    if("serviceWorker" in navigator){
      navigator.serviceWorker.register("service-worker.js")
        .then(()=>console.log("SW registrado"))
        .catch(err=>console.error("SW error",err));
    }
  </script>
</body>
</html>

